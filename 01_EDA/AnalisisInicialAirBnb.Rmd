---
title: "FAD_DataAnalysis_practica"
author: "Alvaro Simón Merino, Antonio Fernández Cáceres, Katsiaryna Zaitsava"
date: "13/11/2021"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1. Cargar Librerías

```{r}
library(dplyr)
library(ggplot2)
library(stringr)
library(readr)
library(batman)
```


## 2. Ingesta y limpieza de datos

Según el diccionario de datos proporcionado con los mismos, se adjunta el significado de cada variable de interés a extraer:

$id$: identificador único de cada espacio alquilable.
$host\_id$: identificador único de cada arrendador.
$host\_since$: fecha en que el arrendador se dio de alta en la plataforma.
$host\_is\_superhost$: indicador lógico de si el arrendador tiene excelentes puntuaciones.
$neighbourhood\_group\_cleansed$: distrito en que se encuentra el espacio alquilable.
$property\_type$: tipo de propiedad.
$room\_type$: tipo de habitación.
$accommodates$: capacidad máxima del espacio.
$bedrooms$: número de cuartos de baño.
$beds$: número de camas de la habitación.
$price$: precio por noche en moneda local.
$minimum\_nights$: mínimo de noches por estancia.
$minimum\_nights\_avg\_ntm$: promedio de mínimo de noches durante los próximos 365 días.
$maximum\_nights\_avg\_ntm$ promedio de máximo de noches durante los próximos 365 días.
$availability\_365$: disponibilidad del espacio durante los próximos 365 días.

Las siguientes variables no aparecen en el diccionario, por lo que entramos a valorarlas: (TODO: revisar esto en alguna otra parte)
$review\_scores\_rating$
$review\_scores\_accuracy$
$review\_scores\_cleanliness$
$review\_scores\_checkin$
$review\_scores\_communication$
$review\_scores\_location$
$review\_scores\_value$
$reviews\_per\_month$

Procedemos a extraer los datos de nuestras variables de interés del fichero $.csv$:

```{r loadData}
RawData <- read.csv(file = '../00_DatosOriginales/listings.csv', header = TRUE)
#summary(RawData)
data <- RawData %>%
  select(id, host_id, host_since, host_is_superhost, neighbourhood_group_cleansed, property_type, room_type, accommodates, bedrooms, price, minimum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, availability_365, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, reviews_per_month)
str(data)
```

En primer lugar, comprobamos que nuestro conjunto de datos tiene 22 variables, aunque no todas han sido clasificadas con el tipo que esperaríamos. $host\_since$ debería ser fecha, $host\_is\_superhost$ debería ser un booleano y $price$ debería ser numérico.

A continuación convertiremos los tipos que no son correctos:

```{r typeConversion}
data$host_since <- as.Date(data$host_since)
data$host_is_superhost <- to_logical(data$host_is_superhost)
data$price<-parse_number(data$price)
```

```{r checkTypes}
str(data)
```

Ahora todos los datos están en el formato correcto.


### 3. Estudio de valores faltantes

```{r summary}
summary(data)
```
Viendo el summary se puede comprobar que:

* $host\_since$ tiene 26 NAs.

* $bedrooms$ tiene 1434 NAs.

* $price$ no tiene NAs, pero el máximo es $9999.0, lo cual no parece verosímil.

* $minimum\_nights\_avg\_ntm$ y $maximum\_nights\_avg\_ntm$ tienen 1 NA. Deberíamos comprobar si pertenecen al mismo id.

* Es factible que $availability\_365$ tenga valores a 0, pero altamente improbable. Debemos estudiarlo.

* Hay más de 5000 NA en todas las variables de Review.



### 4. Análisis exploratorio de datos

TODO: A partir de aquí trabajaremos en ficheros separados de este, y los enlazaremos aquí.

Katya, a partir de aquí solo enlazaremos otros Rmd en los que trabajaremos por separado. De momento dejo aquí el código que generaste por si lo necesitas:



Para dividir nuestros datos, veamos en primero cuántas observaciones hay en cada grupo (por distritos de la ciudad)
```{r}
data %>% 
  group_by(neighbourhood_group_cleansed) %>% 
  count()

```

